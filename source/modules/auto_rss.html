<!-- Find all links tagged with #rss and create an rss feed -->
<!-- If current page has ?feed, go to feed -->

<a id='autoGeneratedReader' target='_blank'>Auto-Generated RSS Reader Link</a>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    // Base URL for the RSS reader
    const baseUrl = 'https://rss-reader.dutl.uk/?feeds=';

    // Select all links on the page
    const links = document.querySelectorAll('a');

    // Filter links ending with #rss
    const rssLinks = Array.from(links)
      .map(link => link.href)
      .filter(href => href.endsWith('#rss'));

    // Encode the links and join them with commas
    const encodedLinks = rssLinks.map(encodeURIComponent).join(',');

    // Construct the final URL
    const rssReaderUrl = `${baseUrl}${encodedLinks}&ttl=30`;

    // Output the URL (you can replace this with any other action)
    console.log(rssReaderUrl);

    // Optionally display the link in the page (e.g., append it to the body)
    const displayLink = document.getElementById('autoGeneratedReader');
    displayLink.href = rssReaderUrl;

    // Check if the current page URL contains '?feed'
    if (window.location.search.includes('?feed')) {
      // Automatically redirect to the RSS reader link
      window.location.href = rssReaderUrl;
    }
  });
</script>
