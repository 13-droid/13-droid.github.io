<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://mistystep.org/static/css/theme.css">
    <link rel="icon" type="image/png" href="https://emoji.dutl.uk/png/64x64/🌫️.png">
    <title>Link seals - self-testing links proof of concept - Misty Step Blog</title>
    
    <meta property="og:title" name="title" content="Link seals - self-testing links proof of concept" />
    <meta property="og:image" name="image" content="https://mistystep.org/static/img/default_img.png" />
    <meta property="og:description" name="description" content="Link seals provide a quick soft-check utility for link health on your web spaces." />
    <meta property="og:type" content="website" />
    <meta property="og:url" name="url" content="https://mistystep.org/blog/testable-links">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Link seals - self-testing links proof of concept">
    <meta name="twitter:description" content="Link seals provide a quick soft-check utility for link health on your web spaces.">
    <meta name="twitter:image" content="https://mistystep.org/static/img/default_img.png">
    <link rel="canonical" href="https://mistystep.org/blog/testable-links" />
    <meta property="og:pubdate" name="pubdate" content="Tue, 14 Jan 2025 00:00:00 +0000" />
    
    <!-- Link to headings -->
<script>
  document.addEventListener('DOMContentLoaded', function () {
    const headings = document.querySelectorAll('main h2, main h3, main h4');
    headings.forEach(function (heading) {
      heading.addEventListener('click', function () {
        window.location.hash = heading.id;
      });
    });
  });
</script>

<!-- Highlight tagged links and texts -->
<script>
  document.addEventListener('DOMContentLoaded', function () {
    document.querySelectorAll('find-tag').forEach(tag => {
      tag.addEventListener('click', () => {
        const searchString = tag.textContent.trim();
        document.querySelectorAll('a').forEach(link => {
          if (link.href.includes(searchString)) {
            link.classList.add('highlighted');
          } else {
            link.classList.remove('highlighted');
          }
        });
        document.querySelectorAll('tag').forEach(tag => {
          if (tag.innerText.includes(searchString)) {
            tag.classList.add('highlighted');
          } else {
            tag.classList.remove('highlighted');
          }
        });
      });
    });
  });
</script>

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-BE6M913MKW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-BE6M913MKW');
</script>

<!-- 🗿🥚 -->

<!-- Sparkles follow cursor (from https://codepen.io/doglol/pen/WNNBRmK) -->
<script>
  var colour="random"; // "random" can be replaced with any valid colour ie: "red"...
  var sparkles=100;// increase of decrease for number of sparkles falling

  var x=ox=400;
  var y=oy=300;
  var swide=800;
  var shigh=600;
  var sleft=sdown=0;
  var tiny=new Array();
  var star=new Array();
  var starv=new Array();
  var starx=new Array();
  var stary=new Array();
  var tinyx=new Array();
  var tinyy=new Array();
  var tinyv=new Array();

  colours=new Array('#ff0000','#00ff00','#ffffff','#ff00ff','#ffa500','#ffff00','#00ff00','#ffffff','ff00ff')

  n = 10;
  y = 0;
  x = 0;
  n6=(document.getElementById&&!document.all);
  ns=(document.layers);
  ie=(document.all);
  d=(ns||ie)?'document.':'document.getElementById("';
  a=(ns||n6)?'':'all.';
  n6r=(n6)?'")':'';
  s=(ns)?'':'.style';

  if (ns){
    for (i = 0; i < n; i++)
        document.write('<layer name="dots'+i+'" top=0 left=0 width='+i/2+' height='+i/2+' bgcolor=#ff0000></layer>');
  }

  if (ie)
    document.write('<div id="con" style="position:absolute;top:0px;left:0px"><div style="position:relative">');

  if (ie||n6){
    for (i = 0; i < n; i++)
        document.write('<div id="dots'+i+'" style="position:absolute;top:0px;left:0px;width:'+i/2+'px;height:'+i/2+'px;background:#ff0000;font-size:'+i/2+'"></div>');
  }

  if (ie)
    document.write('</div></div>');
  (ns||n6)?window.captureEvents(Event.MOUSEMOVE):0;

  function Mouse(evnt){

    y = (ns||n6)?evnt.pageY+4 - window.pageYOffset:event.y+4;
    x = (ns||n6)?evnt.pageX+1:event.x+1;
  }

  (ns)?window.onMouseMove=Mouse:document.onmousemove=Mouse;

  function animate(){

    o=(ns||n6)?window.pageYOffset:0;

    if (ie)con.style.top=document.body.scrollTop + 'px';

    for (i = 0; i < n; i++){

        var temp1 = eval(d+a+"dots"+i+n6r+s);

        randcolours = colours[Math.floor(Math.random()*colours.length)];

        (ns)?temp1.bgColor = randcolours:temp1.background = randcolours; 

        if (i < n-1){

            var temp2 = eval(d+a+"dots"+(i+1)+n6r+s);
            temp1.top = parseInt(temp2.top) + 'px';
            temp1.left = parseInt(temp2.left) + 'px';

        } 
        else{

            temp1.top = y+o + 'px';
            temp1.left = x + 'px';
        }
    }

    setTimeout("animate()",10);
  }

  animate();

  window.onload=function() { if (document.getElementById) {
    var i, rats, rlef, rdow;
    for (var i=0; i<sparkles; i++) {
        var rats=createDiv(3, 3);
        rats.style.visibility="hidden";
        rats.style.zIndex="999";
        document.body.appendChild(tiny[i]=rats);
        starv[i]=0;
        tinyv[i]=0;
        var rats=createDiv(5, 5);
        rats.style.backgroundColor="transparent";
        rats.style.visibility="hidden";
        rats.style.zIndex="999";
        var rlef=createDiv(1, 5);
        var rdow=createDiv(5, 1);
        rats.appendChild(rlef);
        rats.appendChild(rdow);
        rlef.style.top="2px";
        rlef.style.left="0px";
        rdow.style.top="0px";
        rdow.style.left="2px";
        document.body.appendChild(star[i]=rats);
    }
    set_width();
    sparkle();
  }}

  function sparkle() {
    var c;
    if (Math.abs(x-ox)>1 || Math.abs(y-oy)>1) {
        ox=x;
        oy=y;
        for (c=0; c<sparkles; c++) if (!starv[c]) {
            star[c].style.left=(starx[c]=x)+"px";
            star[c].style.top=(stary[c]=y+1)+"px";
            star[c].style.clip="rect(0px, 5px, 5px, 0px)";
            star[c].childNodes[0].style.backgroundColor=star[c].childNodes[1].style.backgroundColor=(colour=="random")?newColour():colour;
            star[c].style.visibility="visible";
            starv[c]=50;
            break;
        }
    }
    for (c=0; c<sparkles; c++) {
        if (starv[c]) update_star(c);
        if (tinyv[c]) update_tiny(c);
    }
    setTimeout("sparkle()", 40);
  }

  function update_star(i) {
    if (--starv[i]==25) star[i].style.clip="rect(1px, 4px, 4px, 1px)";
    if (starv[i]) {
        stary[i]+=1+Math.random()*3;
        starx[i]+=(i%5-2)/5;
        if (stary[i]<shigh+sdown) {
            star[i].style.top=stary[i]+"px";
            star[i].style.left=starx[i]+"px";
        }
        else {
            star[i].style.visibility="hidden";
            starv[i]=0;
            return;
        }
    }
    else {
        tinyv[i]=50;
        tiny[i].style.top=(tinyy[i]=stary[i])+"px";
        tiny[i].style.left=(tinyx[i]=starx[i])+"px";
        tiny[i].style.width="2px";
        tiny[i].style.height="2px";
        tiny[i].style.backgroundColor=star[i].childNodes[0].style.backgroundColor;
        star[i].style.visibility="hidden";
        tiny[i].style.visibility="visible"
    }
  }

  function update_tiny(i) {
    if (--tinyv[i]==25) {
        tiny[i].style.width="1px";
        tiny[i].style.height="1px";
    }
    if (tinyv[i]) {
        tinyy[i]+=1+Math.random()*3;
        tinyx[i]+=(i%5-2)/5;
        if (tinyy[i]<shigh+sdown) {
            tiny[i].style.top=tinyy[i]+"px";
            tiny[i].style.left=tinyx[i]+"px";
        }
        else {
            tiny[i].style.visibility="hidden";
            tinyv[i]=0;
            return;
        }
    }
    else tiny[i].style.visibility="hidden";
  }

  document.onmousemove=mouse;
  function mouse(e) {
    if (e) {
        y=e.pageY;
        x=e.pageX;
    }
    else {
        set_scroll();
        y=event.y+sdown;
        x=event.x+sleft;
    }
  }

  window.onscroll=set_scroll;
  function set_scroll() {
    if (typeof(self.pageYOffset)=='number') {
        sdown=self.pageYOffset;
        sleft=self.pageXOffset;
    }
    else if (document.body && (document.body.scrollTop || document.body.scrollLeft)) {
        sdown=document.body.scrollTop;
        sleft=document.body.scrollLeft;
    }
    else if (document.documentElement && (document.documentElement.scrollTop || document.documentElement.scrollLeft)) {
        sleft=document.documentElement.scrollLeft;
        sdown=document.documentElement.scrollTop;
    }
    else {
        sdown=0;
        sleft=0;
    }
  }

  window.onresize=set_width;
  function set_width() {
    var sw_min=999999;
    var sh_min=999999;
    if (document.documentElement && document.documentElement.clientWidth) {
        if (document.documentElement.clientWidth>0) sw_min=document.documentElement.clientWidth;
        if (document.documentElement.clientHeight>0) sh_min=document.documentElement.clientHeight;
    }
    if (typeof(self.innerWidth)=='number' && self.innerWidth) {
        if (self.innerWidth>0 && self.innerWidth<sw_min) sw_min=self.innerWidth;
        if (self.innerHeight>0 && self.innerHeight<sh_min) sh_min=self.innerHeight;
    }
    if (document.body.clientWidth) {
        if (document.body.clientWidth>0 && document.body.clientWidth<sw_min) sw_min=document.body.clientWidth;
        if (document.body.clientHeight>0 && document.body.clientHeight<sh_min) sh_min=document.body.clientHeight;
    }
    if (sw_min==999999 || sh_min==999999) {
        sw_min=800;
        sh_min=600;
    }
    swide=sw_min;
    shigh=sh_min;
  }

  function createDiv(height, width) {
    var div=document.createElement("div");
    div.style.position="absolute";
    div.style.height=height+"px";
    div.style.width=width+"px";
    div.style.overflow="hidden";
    return (div);
  }

  function newColour() {
    var c=new Array();
    c[0]=255;
    c[1]=Math.floor(Math.random()*256);
    c[2]=Math.floor(Math.random()*(256-c[1]/2));
    c.sort(function(){return (0.5 - Math.random());});
    return ("rgb("+c[0]+", "+c[1]+", "+c[2]+")");
  }
</script>
  </head>
  <body>
    <div class="wrapper">
      <div class="content">
        <nav>
          <p><a href="/rss.xml">RSS</a></p>
<p><img alt="" src="/static/img/ms.png" /></p>
<p><a href="/">Blog</a> | <a href="/about">About</a> | <a href="/blog/following">Following</a> | <a href="/notes">Notes</a></p>
        </nav>
      </div>
      <div class="content">
        <main>
          
          <categoryTag>
            coding
          </categoryTag>
          
          <categoryTag>
            security
          </categoryTag>
          
          <categoryTag>
            automation
          </categoryTag>
          
          <h1 id="link-seals-self-testing-links-proof-of-concept">Link seals - self-testing links proof of concept</h1>
<div class="toc">
<ul>
<li><a href="#link-seals-self-testing-links-proof-of-concept">Link seals - self-testing links proof of concept</a><ul>
<li><a href="#what-is-a-link-seal">What is a link seal</a><ul>
<li><a href="#premise">Premise</a></li>
<li><a href="#example">Example</a></li>
</ul>
</li>
<li><a href="#public-or-private-seal-check-functions">Public or Private Seal Check Functions</a><ul>
<li><a href="#public">Public</a></li>
<li><a href="#private">Private</a></li>
</ul>
</li>
<li><a href="#applications">Applications</a></li>
<li><a href="#challenges">Challenges</a></li>
<li><a href="#live-demo">Live Demo 🚨</a></li>
</ul>
</li>
</ul>
</div>
<p>I was reading <a href="https://shkspr.mobi/blog/2024/12/how-bad-is-link-rot-on-my-blog/" linksealkey="Terence Eden">How bad is link rot on my blog?</a>
on Terence Eden's blog. It’s an article where he shares his experience tending to outgoing links in his blog. He shares
some interesting data on it as well. I encourage you to have a read.  </p>
<p>This is an interesting topic. Let me quote some relevant bits for me to set the scene if you're not bothering to read his full post.  </p>
<blockquote>
<p>Why don't I just cURL the URL and see if it responds with a 2xx HTTP code?  </p>
<p>I used to use an automated checker to test my links. But spam sites lie. Lots of the dead sites have been taken over by scammers, spammers, and AI grifters. They return an HTTP OK and then serve up advertising. Yeuch! So now I spend each morning Tending To My Digital Garden and manually checking the links.  </p>
</blockquote>
<p>So I'm sat here thinking, what if... the scammers could not lie? Or rather, what if you could detect it when they did? Enter⸺  </p>
<h2 id="what-is-a-link-seal">What is a link seal</h2>
<h3 id="premise">Premise</h3>
<p>My proposal is simple; hyperlinks on a webpage could carry information that's going to make it possible to verify if the
source linked contains the expected content. The web page that has the link should define a <strong>link seal check</strong> function, which can be used
to programmatically run through the content on the target page to verify if its content has changed drastically.  </p>
<h3 id="example">Example</h3>
<p>Let’s assume our target page is the following simple hello world page, and it lives on <a href="https://my.site/" linksealkey="Hello World">https://my.site/</a></p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>&lt;<span style="color: #008000; font-weight: bold">html</span>&gt;  
  &lt;<span style="color: #008000; font-weight: bold">head</span>&gt;  
    &lt;<span style="color: #008000; font-weight: bold">title</span>&gt;Hello world&lt;/<span style="color: #008000; font-weight: bold">title</span>&gt;  
  &lt;/<span style="color: #008000; font-weight: bold">head</span>&gt;  
  &lt;<span style="color: #008000; font-weight: bold">body</span>&gt;  
      &lt;<span style="color: #008000; font-weight: bold">p</span>&gt;Hello world!&lt;/<span style="color: #008000; font-weight: bold">p</span>&gt;  
      &lt;<span style="color: #008000; font-weight: bold">p</span>&gt;I'm a website.&lt;/<span style="color: #008000; font-weight: bold">p</span>&gt;  
  &lt;/<span style="color: #008000; font-weight: bold">body</span>&gt;  
&lt;/<span style="color: #008000; font-weight: bold">html</span>&gt;  
</code></pre></div>
<p>Take the following key function.  </p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">function</span><span style="color: #BBB"> </span>linkSealCheck(href,<span style="color: #BBB"> </span>key)<span style="color: #BBB"> </span>{<span style="color: #BBB">  </span>
<span style="color: #BBB">  </span><span style="color: #008000; font-weight: bold">return</span><span style="color: #BBB"> </span>fetch(href)
<span style="color: #BBB">    </span>.then(response<span style="color: #BBB"> </span>=&gt;<span style="color: #BBB"> </span>response.text())
<span style="color: #BBB">    </span>.then(content<span style="color: #BBB"> </span>=&gt;<span style="color: #BBB"> </span>content.includes(key))
<span style="color: #BBB">    </span>.<span style="color: #008000; font-weight: bold">catch</span>(()<span style="color: #BBB"> </span>=&gt;<span style="color: #BBB"> </span><span style="color: #008000; font-weight: bold">false</span>);<span style="color: #BBB"> </span><span style="color: #3D7B7B; font-style: italic">// Return false if the fetch fails</span>
}
</code></pre></div>
<p>The link on our webpage would look like:  </p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>&lt;<span style="color: #008000; font-weight: bold">a</span> <span style="color: #687822">href</span><span style="color: #666">=</span><span style="color: #BA2121">'https://my.site/'</span> <span style="color: #687822">linksealkey</span><span style="color: #666">=</span><span style="color: #BA2121">'Hello world'</span>&gt;My awesome site&lt;/<span style="color: #008000; font-weight: bold">a</span>&gt;  
</code></pre></div>
<p>When we want to verify the links on our blog, we can go through all <code>&lt;a&gt;</code> tags and call the <strong>linkSealCheck</strong> function for each one:  </p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">function</span><span style="color: #BBB"> </span>keySealVerifier()<span style="color: #BBB"> </span>{
<span style="color: #BBB">  </span><span style="color: #008000; font-weight: bold">const</span><span style="color: #BBB"> </span>links<span style="color: #BBB"> </span><span style="color: #666">=</span><span style="color: #BBB"> </span><span style="color: #008000">document</span>.querySelectorAll(<span style="color: #BA2121">'a[linksealkey]'</span>);
<span style="color: #BBB">  </span>links.forEach(link<span style="color: #BBB"> </span>=&gt;<span style="color: #BBB"> </span>{
<span style="color: #BBB">    </span><span style="color: #008000; font-weight: bold">const</span><span style="color: #BBB"> </span>href<span style="color: #BBB"> </span><span style="color: #666">=</span><span style="color: #BBB"> </span>link.href;
<span style="color: #BBB">    </span><span style="color: #008000; font-weight: bold">const</span><span style="color: #BBB"> </span>key<span style="color: #BBB"> </span><span style="color: #666">=</span><span style="color: #BBB"> </span>link.getAttribute(<span style="color: #BA2121">'linksealkey'</span>);
<span style="color: #BBB">    </span>linkSealCheck(href,<span style="color: #BBB"> </span>key).then(isValid<span style="color: #BBB"> </span>=&gt;<span style="color: #BBB"> </span>{
<span style="color: #BBB">      </span><span style="color: #008000; font-weight: bold">if</span><span style="color: #BBB"> </span>(<span style="color: #666">!</span>isValid)<span style="color: #BBB"> </span>{
<span style="color: #BBB">        </span>console.warn(<span style="color: #BA2121">`Link </span><span style="color: #A45A77; font-weight: bold">${</span>href<span style="color: #A45A77; font-weight: bold">}</span><span style="color: #BA2121"> failed the LinkSeal check!`</span>);
<span style="color: #BBB">      </span>}<span style="color: #BBB"> </span><span style="color: #008000; font-weight: bold">else</span><span style="color: #BBB"> </span>{
<span style="color: #BBB">        </span>console.log(<span style="color: #BA2121">`Link </span><span style="color: #A45A77; font-weight: bold">${</span>href<span style="color: #A45A77; font-weight: bold">}</span><span style="color: #BA2121"> passed the LinkSeal check.`</span>);
<span style="color: #BBB">      </span>}
<span style="color: #BBB">    </span>});
<span style="color: #BBB">  </span>});
}
</code></pre></div>
<p>P.S.: This is a very simple implementation of a seal-key pair and a verifier function and it is for illustrative purposes.
Don't come into my inbox saying muh security. I'm talking about you, @infosec.exchange.</p>
<h2 id="public-or-private-seal-check-functions">Public or Private Seal Check Functions</h2>
<p>One (semi) important consideration is whether your <strong>link seal</strong> check function should be public or private.  </p>
<h3 id="public">Public</h3>
<p>A public <strong>link seal</strong> function allows anyone to verify the content of your links. This improves transparency and helps others keep integrity checks
on your website indefinitely. However, it also opens the possibility for abuse, as malicious actors could use the function to scrape information or
exploit your verification mechanism. However, this is highly unlikely except for very specific cases. This is in no way a completely trustable verification
method, but it should do the trick most of the time.</p>
<h3 id="private">Private</h3>
<p>A private <strong>link seal</strong> function is less exposed and can help protect your implementation from misuse. However, this approach limits the ability of third 
parties (e.g., search engines or link-checking tools) to independently verify your links, potentially reducing the reach of your verification mechanism.
However, this is rarely a case for concern, as you'll be doing the gardening for the foreseeable future.</p>
<h2 id="applications">Applications</h2>
<ul>
<li><strong>Gardening</strong>: Reduce link rot and ensure outgoing links still point to accurate, relevant information.</li>
<li><strong>Web Archives</strong>: Cross-check preserved versions of websites against original content snapshots. In theory, you could programmatically go back in time
  on the internet archive until you find a version that satisfies your link seal key.
  Inspired by, again;<blockquote>
<p>(...)
2. If the site is dead, or the content isn't there, I stick the URl into the WayBack Machine and pick the archive closest to the publication date.
(...)
一 Terrence Eden, 'How bad is link rot on my blog?'</p>
</blockquote>
</li>
</ul>
<h2 id="challenges">Challenges</h2>
<ul>
<li><strong>Dynamic Content</strong>: Some sites have rapidly changing content or content that they load with javascript.</li>
<li><strong>Tampering</strong>: A malicious actor could attempt to mimic the expected content to pass checks. </li>
</ul>
<p>With these challenges in mind |I think <strong>link seal</strong> could serve as a simple, programmatic way to provide an extra layer of trust for hyperlinks.
I'm sure we'd be able to find anchor terms in dynamically loaded websites. The worst case for a false negative is someone clicking on an ad, and the
worst case for a false positive is you having to update your <strong>link seal</strong> key.</p>
<p>What do you think? Any ideas? Concerns? Do you think this is a big pile of bull? Reach out to tell me and let's discuss. Find me on <a href="https://mastodon.social/@cemre" linksealkey="some nonsense i would not say">mastodon</a>.</p>
<h2 id="live-demo">Live Demo 🚨</h2>
<p>Here's an MVP implementation of linkseal running on your browser! (I hope this is working because it would be so embarassing if not)</p>
<div id="linkSealLogs"></div>
<script>
  // Utility function to log results to the "linkSealLogs" div
  function logToDiv(message, color) {
    const logDiv = document.getElementById("linkSealLogs");
    if (!logDiv) {
      console.error("Log container with ID 'linkSealLogs' not found.");
      return;
    }
    const logEntry = document.createElement("p");
    logEntry.textContent = message;
    logEntry.style.color = color;
    logDiv.appendChild(logEntry);
  }

  async function fetchWithProxies(href, proxies) {
    for (const proxy of proxies) {
      const proxyUrl = proxy ? `${proxy}${encodeURIComponent(href)}` : href;
      try {
        const response = await fetch(proxyUrl);
        if (response.ok) {
          return await response.json();
        }
      } catch (error) {
        // Continue to the next proxy if there’s an error
      }
    }
    throw new Error(`Failed to fetch ${href} using all provided proxies.`);
  }

  async function linkSealCheck(href, key) {
    try {
      const proxies = [
        "https://api.allorigins.win/get?url=",
        "https://corsproxy.io/?url=",
        "https://test.cors.workers.dev/?",
        "", // Direct fetch if CORS is allowed
      ];

      const data = await fetchWithProxies(href, proxies);
      const content = data.contents || ""; // Handle empty content gracefully

      // Check if the content includes the key
      if (content.includes(key)) {
        logToDiv(`Validation passed for ${href}. Key '${key}' found.`, "chartreuse");
        return true;
      } else {
        logToDiv(`Validation failed for ${href}. Key '${key}' not found.`, "red");
        return false;
      }
    } catch (error) {
      logToDiv(`Error checking link ${href}: ${error.message}`, "red");
      return false;
    }
  }

  async function verifyLinks() {
    const links = document.querySelectorAll('a[linksealkey]');
    for (const link of links) {
      const href = link.href;
      const key = link.getAttribute('linksealkey');
      logToDiv(`Checking link: ${href} with key: '${key}'`, "cornflowerblue");
      await linkSealCheck(href, key);
    }
  }

  // Run the verification on page load
  window.onload = verifyLinks;
</script>
        </main>
      </div>
      <footer>
        <p>misty@mail.co.uk - 🌫️ - 2025</p>
      </footer>
    </div>
  </body>
</html>